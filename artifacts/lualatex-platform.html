<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title>The lualatex-platform package</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="the-lualatex-platform-package">
<h1 class="title">The <tt class="docutils literal"><span class="pre">lualatex-platform</span></tt> package</h1>

<p><a class="reference external" href="http://luatex.org/">LuaTeX</a> does not contain platform-specific code, and while often
platform-specific problems can be handled purely in <a class="reference external" href="http://lua.org/">Lua</a>, it sometimes happens
that access to the native operating system API is required.  For such tasks,
Lua allows loading <em>extension modules</em> written in C (or other languages
provided that they can produce a dynamic library that exports a certain C-style
function).  The <tt class="docutils literal"><span class="pre">lualatex-platform</span></tt> package aims to provide such an extension
module that is usable from both Lua and LuaTeX and adds a small set of features
not available otherwise.  At the moment, it merely supports listing the fonts
known to the operating system.</p>
<div class="section" id="license">
<h1>License</h1>
<p>The <tt class="docutils literal"><span class="pre">lualatex-platform</span></tt> package is <a class="reference external" href="http://www.gnu.org/philosophy/free-sw.html">free software</a>; it is made available
under the conditions of the <a class="reference external" href="http://www.opensource.org/licenses/mit-license.php">Expat (MIT) license</a>, which is reprinted below:</p>
<blockquote>
<p>Copyright © 2011, Philipp Stephani &lt;<a class="reference external" href="mailto:st_philipp&#64;yahoo.de">st_philipp&#64;yahoo.de</a>&gt;</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the “Software”),
to deal in the Software without restriction, including without limitation
the rights to use, copy, modify, merge, publish, distribute, sublicense,
and/or sell copies of the Software, and to permit persons to whom the
Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL
THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.</p>
</blockquote>
</div>
<div class="section" id="installation">
<h1>Installation</h1>
<p>The <tt class="docutils literal"><span class="pre">lualatex-platform</span></tt> package is <a class="reference external" href="https://github.com/phst/lltxplatform">hosted</a> on GitHub; please report any
errors at the <a class="reference external" href="https://github.com/phst/lltxplatform/issues">issue tracker</a>.</p>
<p>The whole bundle consists of a <a class="reference external" href="http://www.latex-project.org/">LaTeX</a> package <tt class="docutils literal"><span class="pre">lualatex-platform.sty</span></tt>, a
<a class="reference external" href="http://mirror.ctan.org/info/luatex/lualatex-doc/lualatex-doc.pdf">LuaLaTeX</a> module <tt class="docutils literal"><span class="pre">lualatex-platform.lua</span></tt>, and the actual C extension module
<tt class="docutils literal"><span class="pre">lltxplatform.(dll|so)</span></tt>.  The extension module should compile for recent
versions of Windows (with <a class="reference external" href="http://mingw.org/">MinGW</a>), OS&nbsp;X, and Linux.  The compilation process is
based on the <a class="reference external" href="http://en.wikipedia.org/wiki/GNU_build_system">GNU&nbsp;build system</a>, so you should be able to compile the module with
the commands:</p>
<pre class="literal-block">
./configure &amp;&amp; make
</pre>
<p>The standard C headers and the Lua headers (<tt class="docutils literal">lua.h</tt> etc.) must be present in
the include path.  On Windows, the compiler needs to access the Lua import
library (<tt class="docutils literal">lua51.lib</tt> or <tt class="docutils literal">liblua51.a</tt>), which must be located in the library
search path.  On Linux, the compiler needs to access the <a class="reference external" href="http://fontconfig.org/">FontConfig</a> header
files (<tt class="docutils literal">fontconfig/fontconfig.h</tt>) and library (<tt class="docutils literal">libfontconfig.so</tt>), which
must be present in the respective search paths.  Run <tt class="docutils literal">./configure <span class="pre">--help</span></tt> for
more options.</p>
<p>After compiling, make sure that the files <tt class="docutils literal"><span class="pre">lualatex-platform.sty</span></tt>,
<tt class="docutils literal"><span class="pre">lualatex-platform.lua</span></tt>, and <tt class="docutils literal"><span class="pre">lltxplatform.(dll|so)</span></tt> can be found by
LuaLaTeX.  On Windows, the native library must be able to find the Lua runtime
library <tt class="docutils literal">lua51.dll</tt>.</p>
</div>
<div class="section" id="usage">
<h1>Usage</h1>
<p>In a LaTeX document or package, load the <tt class="docutils literal"><span class="pre">lualatex-platform</span></tt> package with:</p>
<pre class="literal-block">
\usepackage{lualatex-platform}
</pre>
<p>(or <tt class="docutils literal">\RequirePackage</tt>, of course).  The document should be compiled with the
LuaTeX engine, and the <tt class="docutils literal">luatexbase</tt> module has to be installed.</p>
<p>You can also load the Lua module directly:</p>
<pre class="literal-block">
\RequireLuaModule{lualatex-platform}
</pre>
<p>or, from Lua:</p>
<pre class="literal-block">
luatexbase.require_module(&quot;lualatex-platform&quot;)
</pre>
<p>After the module has been loaded, the table <tt class="docutils literal">lualatex.platform</tt> contains the
functions described below.</p>
<p>Note that on OS&nbsp;X, loading extension modules currently <a class="reference external" href="http://tracker.luatex.org/view.php?id=555">requires</a> a
custom-build LuaTeX binary.</p>
</div>
<div class="section" id="querying-system-fonts">
<h1>Querying system fonts</h1>
<p>The module table <tt class="docutils literal">lualatex.platform</tt> contains two parameterless functions
related to operating system font listing:</p>
<ul>
<li><p class="first"><tt class="docutils literal">get_installed_fonts()</tt> returns either <tt class="docutils literal">nil</tt> (in the case of an error),
or an array of tables each of which represents one font known to the
operating system and contains an arbitrary combination of the following
items:</p>
<ul class="simple">
<li>An item with key <tt class="docutils literal">name</tt>: The value of this item is a string containing
the name of the font as reported by the operating system.  This name is
platform-dependent and largely arbitrary; there is no guarantee that the
name is present or meaningful, and the names are not guaranteed to be
unique within the fonts array.  On Windows and OS&nbsp;X, the string is encoded
in UTF-8; on Linux, the encoding depends on the configuration of the
operating system.  If the font name cannot be obtained, this field is
<tt class="docutils literal">nil</tt>.</li>
<li>An item with key <tt class="docutils literal">path</tt>: The value of this item is a string containing
the file path where the font is located.  There is no guarantee that a file
with this name exists and contains a valid font, and the paths are not
guaranteed to be unique within the fonts array.  On Windows, relative path
names are assumed to be relative to the operating system font directory.
There is no guarantee about whether the path is relative or which path
syntax is used.  On Windows, the string is encoded in the legacy 8-bit file
system encoding (“<a class="reference external" href="http://en.wikipedia.org/wiki/Windows_code_page">ANSI code page</a>”) because the standard C library
functions in the Microsoft runtime don’t accept Unicode strings; if the
file name cannot be represented in the legacy encoding, this field is
<tt class="docutils literal">nil</tt>.  On OS&nbsp;X and Linux, the string is encoded in the current file
system encoding.  If the path cannot be obtained, this field is <tt class="docutils literal">nil</tt>.</li>
</ul>
<p>The array is in arbitrary order, and duplicates are possible.</p>
</li>
<li><p class="first"><tt class="docutils literal">get_inactive_fonts()</tt> returns either <tt class="docutils literal">nil</tt> (in the case of an error), or
an array of strings each of which represents one font treated as inactive by
the operating system.  The concept of <em>inactive fonts</em> exists only on
Windows&nbsp;7 and upwards; the inactive fonts are still present and usable, but
are hidden in standard UI elements.  The array of inactive fonts is in
arbitrary order and the font names are not necessarily unique.  There is no
guarantee that the names returned by <tt class="docutils literal">get_inactive_fonts()</tt> correspond to
actual fonts installed in the system, or to the font names returned by
<tt class="docutils literal">get_installed_fonts()</tt>.  The font names are encoded in UTF-8.</p>
</li>
</ul>
</div>
</div>
</body>
</html>
