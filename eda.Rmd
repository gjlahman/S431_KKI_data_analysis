---
title: "Exploratory Data Analysis"
author: 
  - "Gabriel Lahman"
  - "Rowan Lavelle"
  - "Jordan Majoros"
  - "Matthew Zelenin"
date: "11/11/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r message=FALSE, warning=FALSE}
library(dplyr)
library(tidyr)

kki_demographics = read.csv('data/KKI_demographicInfo.csv')
kki_handedness = read.csv('data/KKI_handedness.csv')
kki_mABC = read.csv('data/KKI_movementAssessmentBatteryforChildren.csv')
kki_SRS = read.csv('data/KKI_SocialResponsivenessScaleQuestionnaire.csv')
kki_WISC = read.csv('data/KKI_WechslerIntelligenceScaleforChildren.csv')


full_dat = full_join(kki_demographics, kki_mABC)
full_dat = full_join(full_dat, kki_SRS)
full_dat = full_join(full_dat, kki_WISC)
full_dat = full_join(full_dat, kki_handedness)
full_dat = full_dat %>% drop_na(c('SecondaryDiagnosis', 'CurrentlyNotTakingMeds', 'CurrentlyTakingAtomoxetine', 'CurrentlyTakingClonidine', 'mABC_TotalStandardScore', 'EdinburghHandedness_Integer'))
full_dat = subset(full_dat, !(is.na(SRS_VERSION) & is.na(WISC_VERSION)))
```


## Research Question

Is there a statistically significant difference in predictive power of the motor skills vs. social responsivness model when we include intelligence metrics as predictors?

```{r message=FALSE, warning=FALSE, fig.align='center'}
library(ggplot2)
```

```{r}
ggplot(full_dat, aes(x=PrimaryDiagnosis, y=mABC_TotalStandardScore, color=PrimaryDiagnosis)) + geom_boxplot()
```

```{r}
ggplot(full_dat, aes(x=mABC_AGE, y=mABC_TotalStandardScore)) + geom_point() + geom_smooth() + geom_smooth(method = 'lm', lty = 2, col = 'red')
```

```{r}
ggplot(subset(full_dat, PrimaryDiagnosis == 'None'), aes(x=mABC_AGE, y=mABC_TotalStandardScore)) + geom_point() + geom_smooth() + geom_smooth(method = 'lm', lty = 2, col = 'red')
ggplot(subset(full_dat, PrimaryDiagnosis == 'ADHD'), aes(x=mABC_AGE, y=mABC_TotalStandardScore)) + geom_point() + geom_smooth() + geom_smooth(method = 'lm', lty = 2, col = 'red')
ggplot(subset(full_dat, PrimaryDiagnosis == 'Autism'), aes(x=mABC_AGE, y=mABC_TotalStandardScore)) + geom_point() + geom_smooth() + geom_smooth(method = 'lm', lty = 2, col = 'red')
```